<div class="container-nav-line">
  <span>Database</span>
</div>
<div class="container">
  <header>
    <h2>Configurar conexão</h2>
  </header>
  <div class="connection-container">
    <form class="form" #f="ngForm" *ngIf="!showForm">
      <div class="form-origin">
        <button mat-raised-button disabled>
          <fa-icon
            class="icon"
            [icon]="icons.database"
            [size]="'xl'"
            title="Dashboards"
          ></fa-icon>
        </button>
        <input
          required=""
          name="username"
          id="username"
          type="text"
          placeholder="Oracle"
          readonly
        />
      </div>
      <div class="form-group">
        <label for="username">Nome da conexão</label>
        <input
          required=""
          name="connection"
          id="connection"
          type="text"
          [(ngModel)]="form.connection"
          autocomplete="off"
        />
      </div>
      <div class="form-group">
        <label for="username">Usuário</label>
        <input
          required=""
          name="username"
          id="username"
          type="text"
          [(ngModel)]="form.username"
          autocomplete="off"
        />
      </div>
      <div class="form-group">
        <label for="password">Senha</label>
        <input
          required=""
          name="password"
          id="password"
          type="password"
          [(ngModel)]="form.password"
          autocomplete="off"
        />
      </div>
      <div class="form-group">
        <label for="url">Host:porta/serviço</label>
        <input
          required=""
          name="url"
          id="url"
          type="text"
          [(ngModel)]="form.url"
          autocomplete="off"
        />
      </div>
      <div class="buttons">
        <button (click)="connectDatabase()" class="action-button add">
          <span *ngIf="!isLoginLoading">Adicionar</span>
          <span *ngIf="isLoginLoading"><div class="login-spinner"></div></span>
        </button>
      </div>
    </form>
    <p-divider layout="vertical" />
    <div class="card-list">
      <span>Lista de conexões</span>
      <p-orderList
        class="list"
        [value]="connections"
        [listStyle]="{ 'max-height': '30rem' }"
        filterBy="name"
        filterPlaceholder="Buscar"
      >
        <ng-template let-connections pTemplate="item" class="card-list-item">
          <div class="flex flex-wrap p-2 align-items-center gap-3">
            <div class="flex-1 flex flex-column gap-2">
              <span>{{ connections.username }}</span>
              <div class="flex align-items-center gap-2">
                <i class="pi pi-tag text-sm"></i>
                <span>{{ formatPassword(connections.password) }}</span>
              </div>
            </div>
            <span [title]="connections.service">
              {{ truncate(connections.service, 60) }}
            </span>
          </div>
          <div>
            <button (click)="connectDatabase()" class="connect-button">
              <span *ngIf="!isLoginLoading">Conectar</span>
              <span *ngIf="isLoginLoading"
                ><div class="login-spinner"></div
              ></span>
            </button>
          </div>
        </ng-template>
      </p-orderList>
    </div>
  </div>
  <div class="db-conected" *ngIf="showForm">
    <img
      src="assets/images/database.svg"
      alt="Imagem banco de dados conectado"
    />
    <h2>O banco está conectado!</h2>
  </div>
</div>
<div class="message">
  <p-toast [life]="2500"></p-toast>
</div>
