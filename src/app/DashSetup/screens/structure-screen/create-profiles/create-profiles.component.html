<div class="container">
  <div class="container-body" id="list">
    <div class="container-content" id="body">
      <div class="container-content-header">
        <h2>Perfis</h2>
        <div class="container-content-header-button-group" id="groupButton">
          <button
            [disabled]="actionButton"
            class="action-button add"
            id="addButton"
            (click)="addRegister()"
          >
            Adicionar
          </button>
          <button
            [disabled]="actionButton"
            class="action-button"
            id="deleteButton"
            (click)="deleteProfiles()"
          >
            Excluir
          </button>
          <button
            [disabled]="actionButton"
            class="action-button"
            id="seeButton"
            (click)="viewProfile()"
          >
            Ver
          </button>
        </div>
      </div>
      <section class="example-container mat-elevation-z8" tabindex="0">
        <p-table
          #tableReference
          matSort
          class="mat-elevation-z8 demo-table"
          selectionMode="single"
          [value]="dataSource"
          (matSortChange)="announceSortChange($event)"
          [(contextMenuSelection)]="selectedProfile"
          [rows]="10"
          [paginator]="true"
          [resizableColumns]="true"
          scrollHeight="350px"
          styleClass="p-datatable-gridlines"
          currentPageReportTemplate="Exibindo de {first} a {last} de {totalRecords} registros"
          [showCurrentPageReport]="true"
          [rowsPerPageOptions]="[10, 25, 50]"
          [globalFilterFields]="['id', 'name', 'observation', 'chartPaths']"
        >
          <ng-template pTemplate="caption">
            <div class="filter">
              <fa-icon
                class="icon"
                [icon]="icons.search"
                [size]="'xl'"
              ></fa-icon>
              <span class="p-input-icon-left">
                <input
                  pInputText
                  type="text"
                  (input)="onInputChange($event, tableReference)"
                  placeholder="Pesquisar"
                />
              </span>
            </div>
          </ng-template>
          <ng-template pTemplate="header">
            <tr>
              <th pResizableColumn style="width: 2rem" pSortableColumn="id">
                <div class="flex align-items-center">Código</div>
              </th>
              <th
                pResizableColumn
                style="min-width: 12rem"
                pSortableColumn="name"
              >
                <div class="flex align-items-center">Nome</div>
              </th>
              <th
                pResizableColumn
                style="min-width: 12rem"
                pSortableColumn="observation"
              >
                <div class="flex align-items-center">Documentação</div>
              </th>

              <th
                pResizableColumn
                style="min-width: 6rem"
                pSortableColumn="chartPaths"
              >
                <div class="flex align-items-center">Pastas</div>
              </th>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-dataSource>
            <tr
              #tr
              pSelectableRow="dataSource"
              pContextMenuRow="dataSource"
              (click)="selectRow(dataSource)"
              (dblclick)="onRowDoubleClick(dataSource)"
              [pSelectableRow]="dataSource"
            >
              <td [title]="dataSource.id">
                {{ dataSource.id }}
              </td>
              <td [title]="dataSource.name">
                {{ dataSource.name }}
              </td>
              <td [title]="dataSource.observation">
                {{ dataSource.observation }}
              </td>
              <td>
                {{ dataSource.chartPaths.length > 0 ? "Sim" : "Não" }}
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="7">Sem registros encontrados</td>
            </tr>
          </ng-template>
        </p-table>
      </section>
    </div>
  </div>

  <div class="container-add" id="add">
    <div class="container-content-add">
      <h2>Adicionar</h2>
    </div>
    <div class="container-add-body">
      <form class="form-search" [formGroup]="createProfilesForm">
        <div>
          <div class="form-group-input">
            <label for="username">Nome do perfil</label>
            <input
              type="text"
              class="form-control"
              name="username"
              autocomplete="off"
              formControlName="name"
              required
              maxlength="60"
            />
          </div>
          <div class="form-group-input">
            <label for="username">Documentação do perfil</label>
            <textarea
              type="text"
              class="form-control-doc"
              name="username"
              autocomplete="off"
              formControlName="observation"
              required
              maxlength="250"
              rows="6"
              cols="50"
            ></textarea>
          </div>
        </div>
        <div class="paths">
          <span>Vincular pasta</span>
          <div style="overflow-y: auto; overflow-x: hidden; margin-top: 8px">
            <p-table
              #tableCreate
              matSort
              class="mat-elevation-z8 demo-table"
              selectionMode="single"
              [value]="listPaths"
              (matSortChange)="announceSortChange($event)"
              [rows]="10"
              [paginator]="true"
              [resizableColumns]="true"
              scrollHeight="250px"
              styleClass="p-datatable-gridlines"
              [globalFilterFields]="['id', 'name']"
            >
              <ng-template pTemplate="caption">
                <div class="filter">
                  <fa-icon
                    class="icon"
                    [icon]="icons.search"
                    [size]="'xl'"
                  ></fa-icon>
                  <span class="p-input-icon-left">
                    <input
                      pInputText
                      type="text"
                      (input)="onInputChange($event, tableCreate)"
                      placeholder="Pesquisar"
                    />
                  </span>
                </div>
              </ng-template>
              <ng-template pTemplate="header">
                <tr>
                  <th style="width: 1rem">
                    <div class="flex align-items-center"></div>
                  </th>
                  <th
                    pResizableColumn
                    style="min-width: 5rem"
                    pSortableColumn="id"
                  >
                    <div class="flex align-items-center">Código</div>
                  </th>
                  <th
                    pResizableColumn
                    style="min-width: 12rem"
                    pSortableColumn="name"
                  >
                    <div class="flex align-items-center">Pasta</div>
                  </th>
                </tr>
              </ng-template>

              <ng-template pTemplate="body" let-listPaths>
                <tr
                  #tr
                  pSelectableRow="listPaths"
                  pContextMenuRow="listPaths"
                  [pSelectableRow]="listPaths"
                >
                  <td>
                    <input
                      type="checkbox"
                      class="checkbox"
                      (change)="printDetails($event, listPaths.id)"
                    />
                  </td>
                  <td>{{ listPaths.id }}</td>
                  <td>{{ listPaths.name }}</td>
                </tr>
              </ng-template>

              <ng-template pTemplate="emptymessage">
                <tr>
                  <td colspan="7">Sem registros encontrados</td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </form>
    </div>
    <div class="container-add-footer">
      <button id="cancel" (click)="cancelRegister()">Cancelar</button>
      <button (click)="createProfile()">Salvar</button>
    </div>
  </div>

  <div class="message">
    <p-toast [life]="2500"></p-toast>
  </div>

  <div class="modal-view-profile" *ngIf="isViewProfile">
    <div class="container-edit-content">
      <h2>Editar</h2>
    </div>
    <div class="container-edit-body">
      <form class="form-search" [formGroup]="editProfilesForm">
        <div>
          <div class="form-group-input">
            <label for="username">Nome do perfil</label>
            <input
              type="text"
              class="form-control"
              name="username"
              autocomplete="off"
              formControlName="name"
              required
              maxlength="60"
              [(ngModel)]="selectedRow!.name"
            />
          </div>
          <div class="form-group-input">
            <label for="username">Documentação do perfil</label>
            <textarea
              type="text"
              class="form-control-doc"
              name="username"
              autocomplete="off"
              formControlName="observation"
              required
              maxlength="250"
              rows="6"
              cols="50"
              [(ngModel)]="selectedRow!.observation"
            ></textarea>
          </div>
        </div>
        <div class="paths">
          <span>Vincular pasta</span>
          <div
            style="
              max-height: 90%;
              overflow-y: auto;
              overflow-x: hidden;
              margin-top: 8px;
            "
          >
            <p-table
              #tableEdit
              matSort
              class="mat-elevation-z8 demo-table"
              selectionMode="single"
              [value]="listPaths"
              (matSortChange)="announceSortChange($event)"
              [rows]="10"
              [paginator]="true"
              [resizableColumns]="true"
              scrollHeight="250px"
              styleClass="p-datatable-gridlines"
              [globalFilterFields]="['id', 'name']"
            >
              <ng-template pTemplate="caption">
                <div class="filter">
                  <fa-icon
                    class="icon"
                    [icon]="icons.search"
                    [size]="'xl'"
                  ></fa-icon>
                  <span class="p-input-icon-left">
                    <input
                      pInputText
                      type="text"
                      (input)="onInputChange($event, tableEdit)"
                      placeholder="Pesquisar"
                    />
                  </span>
                </div>
              </ng-template>
              <ng-template pTemplate="header">
                <tr>
                  <th style="width: 1rem">
                    <div class="flex align-items-center"></div>
                  </th>
                  <th
                    pResizableColumn
                    style="min-width: 5rem"
                    pSortableColumn="id"
                  >
                    <div class="flex align-items-center">Código</div>
                  </th>
                  <th
                    pResizableColumn
                    style="min-width: 12rem"
                    pSortableColumn="name"
                  >
                    <div class="flex align-items-center">Pasta</div>
                  </th>
                </tr>
              </ng-template>

              <ng-template pTemplate="body" let-listPaths>
                <tr
                  #tr
                  pSelectableRow="listPaths"
                  pContextMenuRow="listPaths"
                  [pSelectableRow]="listPaths"
                >
                  <td>
                    <input
                      type="checkbox"
                      class="checkbox"
                      (change)="printDetails($event, listPaths.id)"
                      [checked]="isSelected(listPaths)"
                    />
                  </td>
                  <td>{{ listPaths.id }}</td>
                  <td>{{ listPaths.name }}</td>
                </tr>
              </ng-template>

              <ng-template pTemplate="emptymessage">
                <tr>
                  <td colspan="7">Sem registros encontrados</td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </form>
    </div>
    <div class="container-add-footer">
      <button id="cancel" (click)="notViewProfile()">Voltar</button>
      <button (click)="updateProfile()">Salvar</button>
    </div>
  </div>

  <div
    class="modal"
    *ngIf="deleteProfile"
    id="modal"
    [style.display]="deleteProfile ? 'flex' : 'none'"
  >
    <div class="modal-content">
      <span class="close" (click)="cancelDelete()">&times;</span>
      <div>
        <h2>Tem certeza de que deseja excluir este registro?</h2>
        <p>Esta ação não pode ser desfeita</p>
        <div class="modal-buttons">
          <button class="cancel" (click)="cancelDelete()">cancelar</button>
          <button class="exclude" (click)="confirmDelete()">
            <span>Excluir</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
