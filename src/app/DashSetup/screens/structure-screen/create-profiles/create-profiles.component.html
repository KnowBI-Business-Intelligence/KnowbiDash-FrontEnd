<div class="container">
  <div class="container-body" id="list">
    <div class="container-content" id="body">
      <div class="container-content-header">
        <h2>Perfis</h2>
        <div class="container-content-header-button-group" id="groupButton">
          <button
            [disabled]="actionButton"
            class="action-button add"
            id="addButton"
            (click)="addRegister()"
          >
            Adicionar
          </button>
          <button
            [disabled]="actionButton"
            class="action-button"
            id="deleteButton"
            (click)="deleteProfiles()"
          >
            Excluir
          </button>
          <button
            [disabled]="actionButton"
            class="action-button"
            id="seeButton"
            (click)="viewProfile()"
          >
            Ver
          </button>
        </div>
      </div>
      <section class="example-container mat-elevation-z8" tabindex="0">
        <p-table
          matSort
          class="mat-elevation-z8 demo-table"
          selectionMode="single"
          [value]="dataSource"
          (matSortChange)="announceSortChange($event)"
          [(contextMenuSelection)]="selectedProfile"
          [rows]="10"
          [showCurrentPageReport]="true"
          [rowsPerPageOptions]="[10, 25, 50]"
          [globalFilterFields]="['id', 'name', 'observation', 'chartPaths']"
        >
          <ng-template pTemplate="header">
            <tr>
              <th style="min-width: 5rem" pSortableColumn="id">
                <div class="flex align-items-center">Código</div>
              </th>
              <th style="min-width: 15rem" pSortableColumn="name">
                <div class="flex align-items-center">Nome</div>
              </th>
              <th style="min-width: 15rem" pSortableColumn="observation">
                <div class="flex align-items-center">Documentação</div>
              </th>

              <th style="min-width: 6rem" pSortableColumn="chartPaths">
                <div class="flex align-items-center">Pastas</div>
              </th>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-dataSource>
            <tr
              #tr
              pSelectableRow="dataSource"
              pContextMenuRow="dataSource"
              (click)="selectRow(dataSource)"
              [pSelectableRow]="dataSource"
            >
              <td>
                {{ dataSource.id }}
              </td>
              <td>
                {{ dataSource.name }}
              </td>
              <td>
                {{ dataSource.observation }}
              </td>
              <td>
                {{ dataSource.chartPaths.length > 0 ? "Sim" : "Não" }}
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="7">Sem registros encontrados</td>
            </tr>
          </ng-template>
        </p-table>
      </section>
      <mat-paginator
        [pageSize]="resultsLength"
        [length]="resultsLength"
      ></mat-paginator>
    </div>
  </div>

  <!-- Adicionar perfil -->

  <div class="container-add" id="add">
    <div class="container-content-add">
      <h2>Cadastro de Perfil</h2>
    </div>
    <div class="container-add-body">
      <form class="form-search" [formGroup]="createProfilesForm">
        <div class="form-group-input">
          <label for="username">Nome do perfil</label>
          <input
            type="text"
            class="form-control"
            name="username"
            autocomplete="off"
            formControlName="name"
            required
            maxlength="60"
          />
        </div>
        <div class="form-group-input">
          <label for="username">Documentação do perfil</label>
          <input
            type="text"
            class="form-control"
            name="username"
            autocomplete="off"
            formControlName="observation"
            required
            maxlength="250"
          />
        </div>
      </form>
    </div>
    <div class="container-add-footer">
      <button id="cancel" (click)="cancelRegister()">Cancelar</button>
      <button (click)="createProfile()">Salvar</button>
    </div>
  </div>

  <div class="message">
    <p-toast [life]="1500"></p-toast>
  </div>

  <div class="modal-delete-profile" *ngIf="deleteProfile">
    <div class="container_delete-profile">
      <span>Tem certeza de que deseja excluir este registro?</span>
      <div class="buttons_delete-profile">
        <button
          class="action-buttons_delete-profile yes"
          (click)="confirmDelete()"
        >
          Sim
        </button>
        <button
          class="action-buttons_delete-profile no"
          (click)="cancelDelete()"
        >
          Não
        </button>
      </div>
    </div>
  </div>

  <div class="modal-view-profile" *ngIf="isViewProfile">
    <div class="container_view-profile">
      <span>Informações do perfil:</span>
      <div class="container_profile-infos">
        <div class="container_profile-left">
          <span>Nome: </span>
          <span> {{ selectedRow?.name }}</span>
          <br />
          <span>Documentação: </span>
          <span>{{ selectedRow?.observation }}</span>
        </div>

        <div class="container_profile-rigth">
          Pastas:
          <div class="overflow-content_profile-rigth">
            <div
              class="content_profile-rigth"
              *ngFor="let item of selectedRowChart"
            >
              <span>{{ item.id }}</span>
              <span>{{ item.name }}</span>
            </div>
          </div>
        </div>
      </div>
      <div class="footer_view-profile">
        <p></p>
        <button (click)="notViewProfile()">Voltar</button>
      </div>
    </div>
  </div>
</div>
